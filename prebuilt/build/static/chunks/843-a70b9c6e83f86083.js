(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[843],{9457:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(187);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8291:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(187);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3443:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(187);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},9380:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(187);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},4999:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(187);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7292:function(e,t,r){"use strict";r.r(t),r.d(t,{BlogPostForm:function(){return BlogPostForm}});var n=r(5667),s=r(2026),i=r(6612),a=r(9736),u=r(8712),o=r(9475),l=r(1444),c=r(279),d=r(8260),f=r(9046),p=r(2611),h=r(7993),v=r(8856),m=r(7359),b=r(2113),g=r(5826),x="Switch",[y,S]=(0,h.b)(x),[j,w]=y(x),k=s.forwardRef((e,t)=>{let{__scopeSwitch:r,name:i,checked:a,defaultChecked:u,required:o,disabled:l,value:c="on",onCheckedChange:d,form:h,...m}=e,[b,x]=s.useState(null),y=(0,p.e)(t,e=>x(e)),S=s.useRef(!1),w=!b||h||!!b.closest("form"),[k=!1,C]=(0,v.T)({prop:a,defaultProp:u,onChange:d});return(0,n.jsxs)(j,{scope:r,checked:k,disabled:l,children:[(0,n.jsx)(g.WV.button,{type:"button",role:"switch","aria-checked":k,"aria-required":o,"data-state":getState(k),"data-disabled":l?"":void 0,disabled:l,value:c,...m,ref:y,onClick:(0,f.M)(e.onClick,e=>{C(e=>!e),w&&(S.current=e.isPropagationStopped(),S.current||e.stopPropagation())})}),w&&(0,n.jsx)(BubbleInput,{control:b,bubbles:!S.current,name:i,value:c,checked:k,required:o,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});k.displayName=x;var C="SwitchThumb",N=s.forwardRef((e,t)=>{let{__scopeSwitch:r,...s}=e,i=w(C,r);return(0,n.jsx)(g.WV.span,{"data-state":getState(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t})});N.displayName=C;var BubbleInput=e=>{let{control:t,checked:r,bubbles:i=!0,...a}=e,u=s.useRef(null),o=(0,m.D)(r),l=(0,b.t)(t);return s.useEffect(()=>{let e=u.current,t=window.HTMLInputElement.prototype,n=Object.getOwnPropertyDescriptor(t,"checked"),s=n.set;if(o!==r&&s){let t=new Event("click",{bubbles:i});s.call(e,r),e.dispatchEvent(t)}},[o,r,i]),(0,n.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:u,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function getState(e){return e?"checked":"unchecked"}var _=r(6889);let P=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(k,{className:(0,_.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...s,ref:t,children:(0,n.jsx)(N,{className:(0,_.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});P.displayName=k.displayName;var E=r(1596),I=r(8291),z=r(9457),M=r(2078),R=r(6605),Z=r(2353),D=r.n(Z);function BlogPostForm(e){let{post:t}=e,r=(0,i.useRouter)(),f=!!t,[p,h]=(0,s.useState)((null==t?void 0:t.title)||""),[v,m]=(0,s.useState)((null==t?void 0:t.slug)||""),[b,g]=(0,s.useState)((null==t?void 0:t.content)||""),[x,y]=(0,s.useState)((null==t?void 0:t.excerpt)||""),[S,j]=(0,s.useState)((null==t?void 0:t.featured_image)||""),[w,k]=(0,s.useState)((null==t?void 0:t.published)||!1),[C,N]=(0,s.useState)(null),[_,Z]=(0,s.useState)(!1),O=(0,a.e)(),{toast:W}=(0,E.p)(),generateSlug=()=>{let e=p.toLowerCase().replace(/[^\u0621-\u064A\u0660-\u0669a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");m(e)},handleSubmit=async e=>{e.preventDefault(),N(null),Z(!0);try{if(f){let{error:e}=await O.from("blog_posts").update({title:p,slug:v,content:b,excerpt:x,featured_image:S,published:w,published_at:w?(null==t?void 0:t.published_at)||new Date().toISOString():null,updated_at:new Date().toISOString()}).eq("id",t.id);if(e)throw e;W({title:"تم التحديث",description:"تم تحديث المقال بنجاح"})}else{let{error:e}=await O.from("blog_posts").insert({title:p,slug:v,content:b,excerpt:x,featured_image:S,published:w,published_at:w?new Date().toISOString():null});if(e)throw e;W({title:"تمت الإضافة",description:"تم إضافة المقال بنجاح"})}r.push("/admin/blog"),r.refresh()}catch(e){N(e.message||"حدث خطأ أثناء حفظ المقال")}finally{Z(!1)}};return(0,n.jsx)(d.Zb,{children:(0,n.jsxs)(d.aY,{className:"pt-6",children:[C&&(0,n.jsxs)(M.bZ,{variant:"destructive",className:"mb-6",children:[(0,n.jsx)(I.Z,{className:"h-4 w-4"}),(0,n.jsx)(M.X,{children:C})]}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(l._,{htmlFor:"title",children:"عنوان المقال"}),(0,n.jsx)(o.I,{id:"title",value:p,onChange:e=>h(e.target.value),onBlur:()=>{f&&""!==v||generateSlug()},required:!0})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(l._,{htmlFor:"slug",children:"الرابط (Slug)"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(o.I,{id:"slug",value:v,onChange:e=>m(e.target.value),required:!0,className:"flex-1"}),(0,n.jsx)(u.z,{type:"button",variant:"outline",onClick:generateSlug,children:"إنشاء تلقائي"})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(l._,{htmlFor:"excerpt",children:"مقتطف المقال"}),(0,n.jsx)(c.g,{id:"excerpt",value:x,onChange:e=>y(e.target.value),rows:2}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"ملخص قصير للمقال يظهر في صفحة المقالات (اختياري)"})]}),(0,n.jsx)(R.t,{value:S,onChange:j,label:"الصورة الرئيسية",folder:"blog",helpText:"الصورة الرئيسية للمقال (اختياري)"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(l._,{htmlFor:"content",children:"محتوى المقال"}),(0,n.jsx)(c.g,{id:"content",value:b,onChange:e=>g(e.target.value),required:!0,rows:10})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,n.jsx)(P,{id:"published",checked:w,onCheckedChange:k}),(0,n.jsx)(l._,{htmlFor:"published",children:"نشر المقال"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(D(),{href:"/admin/blog",children:(0,n.jsxs)(u.z,{type:"button",variant:"outline",children:[(0,n.jsx)(z.Z,{className:"mr-2 h-4 w-4"}),"رجوع"]})}),(0,n.jsx)(u.z,{type:"submit",disabled:_,children:_?f?"جاري التحديث...":"جاري الإضافة...":f?"تحديث المقال":"إضافة المقال"})]})]})]})})}},9717:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{unstable_getImgProps:function(){return unstable_getImgProps},default:function(){return o}});let n=r(7295),s=r(6662),i=r(1558),a=r(6752),u=n._(r(4198)),unstable_getImgProps=e=>{(0,i.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,s.getImgProps)(e,{defaultLoader:u.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}},o=a.Image},4355:function(e,t,r){e.exports=r(9717)},6612:function(e,t,r){e.exports=r(9677)},9046:function(e,t,r){"use strict";function composeEventHandlers(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),!1===r||!n.defaultPrevented)return t?.(n)}}r.d(t,{M:function(){return composeEventHandlers}})},7993:function(e,t,r){"use strict";r.d(t,{b:function(){return createContextScope},k:function(){return createContext2}});var n=r(2026),s=r(5667);function createContext2(e,t){let r=n.createContext(t),Provider=e=>{let{children:t,...i}=e,a=n.useMemo(()=>i,Object.values(i));return(0,s.jsx)(r.Provider,{value:a,children:t})};return Provider.displayName=e+"Provider",[Provider,function(s){let i=n.useContext(r);if(i)return i;if(void 0!==t)return t;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function createContextScope(e,t=[]){let r=[],createScope=()=>{let t=r.map(e=>n.createContext(e));return function(r){let s=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return createScope.scopeName=e,[function(t,i){let a=n.createContext(i),u=r.length;r=[...r,i];let Provider=t=>{let{scope:r,children:i,...o}=t,l=r?.[e]?.[u]||a,c=n.useMemo(()=>o,Object.values(o));return(0,s.jsx)(l.Provider,{value:c,children:i})};return Provider.displayName=t+"Provider",[Provider,function(r,s){let o=s?.[e]?.[u]||a,l=n.useContext(o);if(l)return l;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let createScope=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e),i=s[`__scope${n}`];return{...t,...i}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return createScope.scopeName=t.scopeName,createScope}(createScope,...t)]}},325:function(e,t,r){"use strict";r.d(t,{f:function(){return u}});var n=r(2026),s=r(5826),i=r(5667),a=n.forwardRef((e,t)=>(0,i.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{let r=t.target;r.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var u=a},5826:function(e,t,r){"use strict";r.d(t,{WV:function(){return u},jH:function(){return dispatchDiscreteCustomEvent}});var n=r(2026),s=r(7975),i=r(8862),a=r(5667),u=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=n.forwardRef((e,r)=>{let{asChild:n,...s}=e,u=n?i.g7:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(u,{...s,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function dispatchDiscreteCustomEvent(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},6211:function(e,t,r){"use strict";r.d(t,{W:function(){return useCallbackRef}});var n=r(2026);function useCallbackRef(e){let t=n.useRef(e);return n.useEffect(()=>{t.current=e}),n.useMemo(()=>(...e)=>t.current?.(...e),[])}},8856:function(e,t,r){"use strict";r.d(t,{T:function(){return useControllableState}});var n=r(2026),s=r(6211);function useControllableState({prop:e,defaultProp:t,onChange:r=()=>{}}){let[i,a]=function({defaultProp:e,onChange:t}){let r=n.useState(e),[i]=r,a=n.useRef(i),u=(0,s.W)(t);return n.useEffect(()=>{a.current!==i&&(u(i),a.current=i)},[i,a,u]),r}({defaultProp:t,onChange:r}),u=void 0!==e,o=u?e:i,l=(0,s.W)(r),c=n.useCallback(t=>{if(u){let r="function"==typeof t?t(e):t;r!==e&&l(r)}else a(t)},[u,e,a,l]);return[o,c]}},5255:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(2026),s=globalThis?.document?n.useLayoutEffect:()=>{}},7359:function(e,t,r){"use strict";r.d(t,{D:function(){return usePrevious}});var n=r(2026);function usePrevious(e){let t=n.useRef({value:e,previous:e});return n.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},2113:function(e,t,r){"use strict";r.d(t,{t:function(){return useSize}});var n=r(2026),s=r(5255);function useSize(e){let[t,r]=n.useState(void 0);return(0,s.b)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let n,s;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;n=t.inlineSize,s=t.blockSize}else n=e.offsetWidth,s=e.offsetHeight;r({width:n,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}}}]);