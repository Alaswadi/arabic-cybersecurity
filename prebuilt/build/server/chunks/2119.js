"use strict";exports.id=2119,exports.ids=[2119],exports.modules={61243:(e,s,t)=>{t.r(s),t.d(s,{BlogPostForm:()=>BlogPostForm});var a=t(67622),l=t(50789),r=t(11955),i=t(81300),n=t(2877),o=t(84059),c=t(97301),d=t(13831),u=t(38307),h=t(65496),g=t(54155);let m=l.forwardRef(({className:e,...s},t)=>a.jsx(h.fC,{className:(0,g.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:t,children:a.jsx(h.bU,{className:(0,g.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));m.displayName=h.fC.displayName;var x=t(16785),p=t(62511),b=t(56819),f=t(94408),j=t(48298),v=t(36698),S=t.n(v);function BlogPostForm({post:e}){let s=(0,r.useRouter)(),t=!!e,[h,g]=(0,l.useState)(e?.title||""),[v,y]=(0,l.useState)(e?.slug||""),[w,N]=(0,l.useState)(e?.content||""),[_,C]=(0,l.useState)(e?.excerpt||""),[k,F]=(0,l.useState)(e?.featured_image||""),[B,D]=(0,l.useState)(e?.published||!1),[I,P]=(0,l.useState)(null),[q,z]=(0,l.useState)(!1),Z=(0,i.e)(),{toast:O}=(0,x.p)(),generateSlug=()=>{let e=h.toLowerCase().replace(/[^\u0621-\u064A\u0660-\u0669a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");y(e)},handleSubmit=async a=>{a.preventDefault(),P(null),z(!0);try{if(t){let{error:s}=await Z.from("blog_posts").update({title:h,slug:v,content:w,excerpt:_,featured_image:k,published:B,published_at:B?e?.published_at||new Date().toISOString():null,updated_at:new Date().toISOString()}).eq("id",e.id);if(s)throw s;O({title:"تم التحديث",description:"تم تحديث المقال بنجاح"})}else{let{error:e}=await Z.from("blog_posts").insert({title:h,slug:v,content:w,excerpt:_,featured_image:k,published:B,published_at:B?new Date().toISOString():null});if(e)throw e;O({title:"تمت الإضافة",description:"تم إضافة المقال بنجاح"})}s.push("/admin/blog"),s.refresh()}catch(e){P(e.message||"حدث خطأ أثناء حفظ المقال")}finally{z(!1)}};return a.jsx(u.Zb,{children:(0,a.jsxs)(u.aY,{className:"pt-6",children:[I&&(0,a.jsxs)(f.bZ,{variant:"destructive",className:"mb-6",children:[a.jsx(p.Z,{className:"h-4 w-4"}),a.jsx(f.X,{children:I})]}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"title",children:"عنوان المقال"}),a.jsx(o.I,{id:"title",value:h,onChange:e=>g(e.target.value),onBlur:()=>{t&&""!==v||generateSlug()},required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"slug",children:"الرابط (Slug)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(o.I,{id:"slug",value:v,onChange:e=>y(e.target.value),required:!0,className:"flex-1"}),a.jsx(n.z,{type:"button",variant:"outline",onClick:generateSlug,children:"إنشاء تلقائي"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"excerpt",children:"مقتطف المقال"}),a.jsx(d.g,{id:"excerpt",value:_,onChange:e=>C(e.target.value),rows:2}),a.jsx("p",{className:"text-sm text-gray-500",children:"ملخص قصير للمقال يظهر في صفحة المقالات (اختياري)"})]}),a.jsx(j.t,{value:k,onChange:F,label:"الصورة الرئيسية",folder:"blog",helpText:"الصورة الرئيسية للمقال (اختياري)"}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"content",children:"محتوى المقال"}),a.jsx(d.g,{id:"content",value:w,onChange:e=>N(e.target.value),required:!0,rows:10})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[a.jsx(m,{id:"published",checked:B,onCheckedChange:D}),a.jsx(c._,{htmlFor:"published",children:"نشر المقال"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx(S(),{href:"/admin/blog",children:(0,a.jsxs)(n.z,{type:"button",variant:"outline",children:[a.jsx(b.Z,{className:"mr-2 h-4 w-4"}),"رجوع"]})}),a.jsx(n.z,{type:"submit",disabled:q,children:q?t?"جاري التحديث...":"جاري الإضافة...":t?"تحديث المقال":"إضافة المقال"})]})]})]})})}},47048:(e,s,t)=>{t.d(s,{n:()=>n});var a=t(89408);let l=(0,a.createProxy)(String.raw`C:\Users\fadia\Documents\augment-projects\arabic-cybersecurity\components\admin\blog-post-form.tsx`),{__esModule:r,$$typeof:i}=l;l.default;let n=l.BlogPostForm}};